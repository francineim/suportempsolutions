"""
Streamlit App Entry Point
"""

import sys
import os
import streamlit as st

# Configurar o path
current_dir = os.path.dirname(os.path.abspath(__file__))
app_dir = os.path.join(current_dir, 'app')
sys.path.insert(0, app_dir)

# Configurar pÃ¡gina
st.set_page_config(
    page_title="Helpdesk - MP Solutions",
    page_icon="ğŸ«",
    layout="wide",
    initial_sidebar_state="expanded"
)

# Verificar e criar diretÃ³rios necessÃ¡rios
required_dirs = ['data', 'uploads', 'backups']
for dir_name in required_dirs:
    if not os.path.exists(dir_name):
        os.makedirs(dir_name)
        print(f"âœ… DiretÃ³rio '{dir_name}' criado")

# Importar e executar o main
try:
    from app.main import main
    main()
except Exception as e:
    st.error(f"âŒ Erro ao iniciar a aplicaÃ§Ã£o: {str(e)}")
    st.info("""
    âš ï¸ **Problemas comuns:**
    
    1. **Banco de dados nÃ£o inicializado:** 
       - Clique em "Force Fix" na sidebar (se disponÃ­vel)
       - Ou execute o script de inicializaÃ§Ã£o manualmente
    
    2. **Problemas de importaÃ§Ã£o:**
       - Verifique se a estrutura de pastas estÃ¡ correta
       
    3. **PermissÃµes de arquivo:**
       - Certifique-se de que os diretÃ³rios `data/` e `uploads/` tÃªm permissÃ£o de escrita
    """)
    
    # BotÃ£o para forÃ§ar inicializaÃ§Ã£o
    if st.button("ğŸ”„ Tentar Recarregar"):
        st.rerun()
